# –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

<details>
<summary>1. –í–≤–µ–¥–µ–Ω–∏–µ –≤ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é</summary>

## –ó–∞–¥–∞—á–∞ 2

| –ó–∞–¥–∞—á–∞ | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ | –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–±–æ—Ä–∞ |
|--------|-------------------------|------------------|
| –í—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö MySQL, –∫—Ä–∏—Ç–∏—á–Ω–∞—è –∫ –æ—Ç–∫–∞–∑—É | –§–∏–∑–∏—á–µ—Å–∫–∏–µ —Å–µ—Ä–≤–µ—Ä—ã | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å I/O, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–¥–µ—Ä–∂–µ–∫ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏, –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –∂–µ–ª–µ–∑—É, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ RAID |
| –†–∞–∑–ª–∏—á–Ω—ã–µ web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —É—Ä–æ–≤–Ω—è –û–° (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã) | –ë—ã—Å—Ç—Ä–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–∑–æ–ª—è—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ |
| Windows-—Å–∏—Å—Ç–µ–º—ã –¥–ª—è –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–æ–≥–æ –æ—Ç–¥–µ–ª–∞ | –ü–∞—Ä–∞–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è | –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å 1–° –∏ —Ç.–ø. –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏, —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, —Å–Ω–∞–ø—à–æ—Ç—ã –¥–ª—è –±—ç–∫–∞–ø–æ–≤, –∏–∑–æ–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| –°–∏—Å—Ç–µ–º—ã –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞—Å—á—ë—Ç–æ–≤ –Ω–∞ GPU | –§–∏–∑–∏—á–µ—Å–∫–∏–µ —Å–µ—Ä–≤–µ—Ä—ã | –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ GPU, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ overhead, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å CUDA/OpenCL, –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ |

## –ó–∞–¥–∞–Ω–∏–µ 3

| –°—Ü–µ–Ω–∞—Ä–∏–π | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ |
|----------|----------------------|-------------|--------------|
| 100 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω –Ω–∞ –±–∞–∑–µ Linux –∏ Windows, –æ–±—â–∏–µ –∑–∞–¥–∞—á–∏, –Ω–µ—Ç –æ—Å–æ–±—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ Windows based-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π. | Microsoft Hyper-V | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AD, PowerShell, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏, —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å | Proxmox VE |
| –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ open source-—Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–µ–±–æ–ª—å—à–æ–π (20-30 —Å–µ—Ä–≤–µ—Ä–æ–≤) –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–∞ –±–∞–∑–µ Linux –∏ Windows –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω. | Proxmox VE (KVM + LXC) | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Windows –∏ Linux, –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∫–ª–∞—Å—Ç–µ—Ä—ã, live migration, —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ | oVirt |
| –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ Windows-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. | Microsoft Hyper-V | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Windows, –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –≤—Å—Ç—Ä–æ–µ–Ω –≤ Windows Server | KVM —Å VirtIO-–¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ |
| –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–±–æ—á–µ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞—Ö Linux. | Docker/Docker Swarm | –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è CLI, VirtualBox –¥–ª—è GUI, –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å, –ø—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏. –î–ª—è –æ–∫—Ä—É–∂–µ–Ω–∏–π –¥–æ 10 –º–∞—à–∏–Ω Kubernetes –±—É–¥–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–∏–º —Ä–µ—à–µ–Ω–∏–µ–º. | Vagrant + VirtualBox/Libvirt. –í–æ–∑–º–æ–∂–µ–Ω k8s.|

## –ó–∞–¥–∞—á–∞ 4

–û–ø–∏—à–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–∏—Å—Ç–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ) –∏ —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —ç—Ç–∏—Ö —Ä–∏—Å–∫–æ–≤ –∏ –ø—Ä–æ–±–ª–µ–º. –ï—Å–ª–∏ –±—ã —É –≤–∞—Å –±—ã–ª –≤—ã–±–æ—Ä, —Å–æ–∑–¥–∞–≤–∞–ª–∏ –±—ã –≤—ã –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω—É—é —Å—Ä–µ–¥—É –∏–ª–∏ –Ω–µ—Ç?

1) –ü—Ä–æ–±–ª–µ–º—ã –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏.

–∞) –ì–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞–∫ NP-–ø–æ–ª–Ω–∞—è –∑–∞–¥–∞—á–∞.

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π NP-–ø–æ–ª–Ω—É—é –∑–∞–¥–∞—á—É, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ ¬´–∑–∞–¥–∞—á–µ —Ä—é–∫–∑–∞–∫–∞¬ª. –û–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç –∫–æ–Ω–µ—á–Ω–æ–≥–æ –æ–±—ä—ë–º–∞ —Ä–µ—Å—É—Ä—Å–æ–≤, –≤ —Ä–∞–º–∫–∞—Ö –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ ¬´—É–ø–∞–∫–æ–≤–∞—Ç—å¬ª —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Ö–æ—Å—Ç–∞—Ö —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤. –¶–µ–ª—å ‚Äî –¥–æ—Å—Ç–∏—á—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ ¬´–æ–±—ä—ë–º–∞¬ª (—Ç.–µ. –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏) –ø—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ö–æ—Å—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –∏–ª–∏ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –¥—Ä—É–≥–æ–π —Ç–∏–ø –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏). –ü—Ä–∏–º–µ—Ä: –º–∏–≥—Ä–∞—Ü–∏—è —Å Hyper-V –Ω–∞ Proxmox –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Å–∏—Å—Ç–µ–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ Hyper-V, –∞ –¥—Ä—É–≥–∞—è ‚Äî –Ω–µ—Ç, –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å QoS, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ—Ç–¥–µ–ª–µ–Ω–∏—è —á–∞—Å—Ç–Ω–æ–π —Ö–∏—Ä—É—Ä–≥–∏–∏.

–±) –ì–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞–∫ NP-—Ç—Ä—É–¥–Ω–∞—è –∑–∞–¥–∞—á–∞.

 –°–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç –¥–æ NP-—Ç—Ä—É–¥–Ω–æ–π, –µ—Å–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É (—Ä–æ–±–æ—Ç—ã, –¥—Ä–æ–Ω—ã, IoTT, Kubernetes + OpenStack, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã Astra Linux –∏ –¥—Ä.), —á—Ç–æ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏ —Ä–µ—à–µ–Ω–∏–π. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é NP-—Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤–Ω–æ—Å–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π.
 –î–ª—è —Ç–∞–∫–∏—Ö –∑–∞–¥–∞—á —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

2) –û–±—â–∏–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∏—Å–∫–æ–≤.

‚Ä¢ –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) —Å–µ—Ç—å –º–µ–ª–∫–∏—Ö –∏–ª–∏ —Å—Ä–µ–¥–Ω–∏—Ö —Ö–æ—Å—Ç–æ–≤ –Ω–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–º (middleware) —É—Ä–æ–≤–Ω–µ cloud-IoT (–∫–∞–∫ –ø—Ä–∏–º–µ—Ä), —Ç–µ–º —Å–∞–º—ã–º —Ä–µ–∞–ª–∏–∑—É—è –∏–¥–µ—é –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ–≥–æ –ø—É–ª–∞ –ø—Ä–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π –≥–æ–º–æ–≥–µ–Ω–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ (CPU, RAM, GPU) —Å —É—á—ë—Ç–æ–º –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –º–µ–∂–¥—É QoS –∏ SLA.

‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ atomic hosts –ª–∏–±–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö immutable Docker-–æ–±—Ä–∞–∑–æ–≤, –ø–æ—è–≤–∏–≤—à–∏—Ö—Å—è –Ω–µ–¥–∞–≤–Ω–æ.

‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, BGP, –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∞–Ω–æ–º–∞–ª–∏–π AS_PATH –∏ –º–µ—Ç—Ä–∏–∫ QoS/SLA.

‚Ä¢ –ü–æ–Ω–∏–º–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ QoS/SLA, Latency Greedy, Cost Greedy, GeKube).

‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–¥–∞–ø—Ç–∏—Ä—É—é—â–∏—Ö—Å—è —ç–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤. –î–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ–π –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏. –¢–∞–∫, –¥–ª—è –ª–∏–Ω–µ–π–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ CPU/Memory, IOPS –∫ —É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ –¥–∏—Å–∫–∞ –∏ —Ç.–ø.) —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ Granger causality. –í —Ç–æ –∂–µ –≤—Ä–µ–º—è, –¥–ª—è –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ ‚Äî CPU, GPU, Memory ‚Äî —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, —Ç—Ä–µ–±—É—é—â–µ–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è –∏–ª–∏ —Ä–∞—Å—á—ë—Ç–∞ —Å—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π; –≤ —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–æ–¥–µ–ª–∏ ARIMA –∏–ª–∏ SARIMA.

‚Ä¢ –ü–æ–ª–∏—Ç–∏–∫–∞, –≥–¥–µ –º–∏–≥—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–π —É–∑–µ–ª –±—É–¥–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–µ–µ –µ–≥–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ –æ–¥–Ω–∞ –Ω–æ–¥–∞ –Ω–µ –ø–æ–ª—É—á–∏—Ç —Ä–µ—Å—É—Ä—Å–æ–≤ –±–æ–ª—å—à–µ —Å–∞–º–æ–π —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–æ–π.

3) –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ —Å –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–æ–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ Kubernetes –≤ GitHub.

- eddytruyen/heterogenous-scaling-in-k8s - –≤–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–∏–º—É–ª—è—Ü–∏–∏ –Ω–∞–≥—Ä—É–∑–æ–∫, —Å–æ–∑–¥–∞–Ω–∏–µ YAML-–º–∞—Ç—Ä–∏—Ü –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–∏—Å–≤–æ–µ–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ (–ó–æ–ª–æ—Ç–æ, –ë—Ä–æ–Ω–∑–∞), –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ —Å–≤–æ–∏–º –Ω–µ–π–º—Å–ø–µ–π—Å–æ–º –∏ –ø–æ–¥–æ–º resource-planner. Graphite –¥–ª—è –º–µ—Ç—Ä–∏–∫ (push-based). Heapster, Grafana - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è.

- lippertmarkus/vagrant-k8s-win-hostprocess - –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ –±–∞–∑–µ Vagrant –∫–ª–∞—Å—Ç–µ—Ä –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–¥–∞–º–∏ —Ç–∏–ø–∞ winworker —Å –ø–æ–º–æ—â—å—é Windows HostProcess Pods, —Å –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –∏ —Å –¥—Ä—É–≥–æ–π - Calico/CNI –¥–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –ª–∏–Ω—É–∫—Å –Ω–æ–¥, –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤—ã—Ö Windows —Å–µ—Ä–≤–∏—Å–æ–≤.

- hufs-ese-lab/MC-Kube (–∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ –≤–æ–∂–¥–µ–Ω–∏–µ, –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π IoT), –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ —É—Ä–æ–≤–Ω–µ eBPF c —É–º–µ–Ω—å—à–µ–Ω–∏–µ–º –æ—Ç–∫–ª–∏–∫–∞ –≤ 246 —Ä–∞–∑ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ API –∑–∞–ø—Ä–æ—Å–∞–º–∏ k8s, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø–∞—Ç—á–∏–Ω–≥–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ Completely Fair (CFS) —à–µ–¥—É–ª–µ—Ä–∞ (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ SCHED_DEADLINE –¥–ª—è –ø–æ–¥–æ–≤ —á–µ—Ä–µ–∑ –ø–∞—Ç—á–∏), –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–Ω—Ç–∞–π–º–∞ (–∑–∞–¥–∞—á–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ –¥–µ–¥–ª–∞–π–Ω –ø–æ–ø–∞–¥–∞–µ—Ç –≤ runtime_hi).

4) –ü—Ä–æ–±–ª–µ–º—ã –≤—ã–±–æ—Ä–∞ –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã.

–í –±–ª–∏–∂–∞–π—à–∏–µ 20 –ª–µ—Ç, —Å —É—á—ë—Ç–æ–º —Ä–∞–∑–≤–∏—Ç–∏—è –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –Ω–µ–π—Ä–æ–º–æ—Ä—Ñ–Ω—ã—Ö —á–∏–ø–æ–≤, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤–µ—â–µ–π (IoT) –∏ —Ä–æ–±–æ—Ç–∏–∑–∞—Ü–∏–∏, –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–∞–Ω–µ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–π.
</details>
<details>
<summary>2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ IaaC –≤ —Ä–∞–±–æ—Ç–µ —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –º–∞—à–∏–Ω–∞–º–∏</summary>

## –ó–∞–¥–∞—á–∞ 2

![–°–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ó–∞–¥–∞–Ω–∏—è 2](2.png)

## –ó–∞–¥–∞—á–∞ 3

![–°–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ó–∞–¥–∞–Ω–∏—è 3](3-1.png)

![–°–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ó–∞–¥–∞–Ω–∏—è 3](3.png)

</details>

<details>
<summary>4. –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≥—Ä—É–ø–ø–æ–π Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ Docker Compose</summary>


## –ó–∞–¥–∞—á–∞ 1

[–°—Å—ã–ª–∫–∞ –Ω–∞ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: slateecho/custom-nginx](https://hub.docker.com/repository/docker/slateecho/custom-nginx/general)

## –ó–∞–¥–∞—á–∞ 2

![–°–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ó–∞–¥–∞–Ω–∏—è 2](5-2-2.png)

## –ó–∞–¥–∞—á–∞ 3

–ü–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ docker attach –æ–ø—Ü–∏—è --sig-proxy[=true] –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–∞, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∫ PID 1 –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –∫–∞–∫ –µ—Å–ª–∏ –±—ã –æ–Ω –±—ã–ª –∑–∞–ø—É—â–µ–Ω –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ. –ü—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ SIGINT (^C), –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –µ–≥–æ.

![–°–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ó–∞–¥–∞–Ω–∏—è 3](5-3-1.png)

![–°–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ó–∞–¥–∞–Ω–∏—è 3](5-3-2.png)

![–°–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ó–∞–¥–∞–Ω–∏—è 3](5-3-3.png)

![–°–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ó–∞–¥–∞–Ω–∏—è 3](5-3-4.png)

–ü–æ—Å–∫–æ–ª—å–∫—É –º–∞–ø–ø–∏–Ω–≥ –ø–æ—Ä—Ç–æ–≤, –∫–∞–∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ –≤—ã—à–µ, –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—É—Å–∫–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è, –∞ –≤ –ª–æ–≥–∞—Ö –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∑–∞–ø–∏—Å—å "10-listen-on-ipv6-by-default.sh: info: /etc/nginx/conf.d/default.conf differs from the packaged version", –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω—ã–º –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Nginx –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø—É—Ç—ë–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –µ–≥–æ conf —Ñ–∞–π–ª–∞ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

*–ù–∞ –æ—Å–Ω–æ–≤–µ —É–ø–æ–º—è–Ω—É—Ç–æ–≥–æ https://www.baeldung.com/ops/assign-port-docker-container –º–∞–Ω—É–∞–ª–∞ –∏–∑–º–µ–Ω—ë–Ω –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç —Å 80 –Ω–∞ 81.

![–°–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ó–∞–¥–∞–Ω–∏—è 3](5-3-5.png)

## –ó–∞–¥–∞—á–∞ 3

1) –ë—ã–ª –∑–∞–ø—É—â–µ–Ω —Ñ–∞–π–ª compose.yaml (—Å —Å–µ—Ä–≤–∏—Å–æ–º portainer), –ø–æ—Å–∫–æ–ª—å–∫—É, –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ –∞–¥—Ä–µ—Å—É https://docs.docker.com/compose/intro/compose-application-model/, —ç—Ç–æ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Docker Compose.

2) –°–∫—Ä–∏–Ω—à–æ—Ç –≤—Ç–æ—Ä–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ nginx.

![–°–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ó–∞–¥–∞–Ω–∏—è 3](5-4-2.png)

3) –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è compose.yaml –æ—Å—Ç–∞–ª—Å—è "—Å–∏—Ä–æ—Ç—Å–∫–∏–π" –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Portainer, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–∏.

![–°–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ó–∞–¥–∞–Ω–∏—è 3](5-4-1.png)

</details>

<details>
<summary>5. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Docker</summary>


## **–ó–∞–¥–∞—á–∞ 0**
–í—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–∞–±–æ—á–µ–π —Å—Ä–µ–¥—ã: –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ `docker-compose` (V1) –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è Docker Compose Plugin (V2) –∫–∞–∫ —á–∞—Å—Ç—å Docker Engine. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Docker –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∫–æ–º–∞–Ω–¥ —Å –ø—Ä–æ–±–µ–ª–æ–º (`docker compose`).

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/docker_compose.png)

## **–ó–∞–¥–∞—á–∞ 1**
–°–æ–∑–¥–∞–Ω —Ñ–æ—Ä–∫ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –í–Ω–µ—Å–µ–Ω—ã —Ç—Ä–µ–±—É–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω `Dockerfile.python` –Ω–∞ –æ—Å–Ω–æ–≤–µ `python:3.12-slim`, —Å–æ–∑–¥–∞–Ω—ã —Ñ–∞–π–ª—ã `.dockerignore` –∏ `.gitignore`. –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ FastAPI —Å –ø–æ–º–æ—â—å—é `uvicorn` –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ.

–¢–µ—Å—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å–±–æ—Ä–∫–∏:

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/2/2-0.png)

–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ docker-compose c —É–∫–∞–∑–∞–Ω–∏–µ–º –Ω–∞ Dockerfile.python:

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/2/2-0.png)

**–ó–∞–ø—É—â–µ–Ω main.py —á–µ—Ä–µ–∑ python3-venv:

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/2/2.png)
![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/2/2-1.png)

***–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å

–ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:

```python
from datetime import datetime
import os
import time
from contextlib import contextmanager, asynccontextmanager

import mysql.connector
from fastapi import FastAPI, Request, Depends, Header
from typing import Optional


# --- 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ---
# –°—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ë–î –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
db_host = os.environ.get('DB_HOST')
db_user = os.environ.get('MYSQL_USER')
db_password = os.environ.get('MYSQL_PASSWORD')
db_name = os.environ.get('MYSQL_DATABASE')
db_table = os.environ.get('MYSQL_TABLE')
db_auth_plugin = 'caching_sha2_password'

@asynccontextmanager
async def lifespan(app: FastAPI):
    # –ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    print("–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    try:
        # Retry loop to wait for MySQL
        db = None
        for attempt in range(10):
            try:
                db = mysql.connector.connect(
                    host=db_host,
                    user='root',
                    password=os.environ.get('MYSQL_ROOT_PASSWORD')
                )
                break
            except mysql.connector.Error as err:
                print(f"MySQL not ready yet (attempt {attempt + 1}/10): {err}")
                time.sleep(3)
        else:
            print("MySQL did not become ready in time.")
            yield
            return

        cursor = db.cursor()
        # Create database if not exists
        cursor.execute(f"CREATE DATABASE IF NOT EXISTS `{db_name}`")
        db.commit()
        cursor.close()
        db.close()

        # Connect to database
        db = mysql.connector.connect(
            host=db_host,
            user='root',
            password=os.environ.get('MYSQL_ROOT_PASSWORD'),
            database=db_name
        )
        cursor = db.cursor()
        create_user_query = f"""
        CREATE USER IF NOT EXISTS '{db_user}'@'%' IDENTIFIED WITH {db_auth_plugin} BY '{db_password}';
        GRANT ALL PRIVILEGES ON `{db_name}`.* TO '{db_user}'@'%';
        FLUSH PRIVILEGES;
        """
        cursor.execute(create_user_query)
        db.commit()
        # Create table
        create_table_query = f"""
        CREATE TABLE IF NOT EXISTS `{db_table}` (
            id INT AUTO_INCREMENT PRIMARY KEY,
            request_date DATETIME,
            request_ip VARCHAR(255)
        )
        """
        cursor.execute(create_table_query)
        db.commit()
        print(f"–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏ —Ç–∞–±–ª–∏—Ü–∞ \'{db_table}\' –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ.")
        cursor.close()
        db.close()
    except mysql.connector.Error as err:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –ë–î –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü—ã: {err}")

    yield

    # –ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    print("–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è.")


# –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä FastAPI —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º lifespan
app = FastAPI(
    title="Shvirtd Example FastAPI",
    description="–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, FastAPI+Docker.",
    version="1.0.0",
    lifespan=lifespan
)


# --- 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º —Å –ë–î ---
@contextmanager
def get_db_connection():
    db = None
    try:
        db = mysql.connector.connect(
            host=db_host,
            user=db_user,
            password=db_password,
            database=db_name
        )
        yield db
    finally:
        if db is not None and db.is_connected():
            db.close()


# --- 3. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è IP ---
def get_client_ip(x_real_ip: Optional[str] = Header(None)):
    return x_real_ip


# --- 5. –û—Å–Ω–æ–≤–Ω–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç ---
@app.get("/")
def index(request: Request, ip_address: Optional[str] = Depends(get_client_ip)):
    final_ip = ip_address  # –¢–æ–ª—å–∫–æ –∏–∑ X-Forwarded-For, –±–µ–∑ fallback

    now = datetime.now()
    current_time = now.strftime("%Y-%m-%d %H:%M:%S")

    try:
        with get_db_connection() as db:
            cursor = db.cursor()
            query = f"INSERT INTO `{db_table}` (request_date, request_ip) VALUES (%s, %s)"
            values = (current_time, final_ip)
            cursor.execute(query, values)
            db.commit()
            cursor.close()
    except mysql.connector.Error as err:
        return {"error": f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö: {err}"}

    # –ü–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏
    if final_ip is None:
        ip_display = "–ø–æ—Ö–æ–∂–µ, —á—Ç–æ –≤—ã –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç–µ –∑–∞–ø—Ä–æ—Å –≤ –Ω–µ–≤–µ—Ä–Ω—ã–π –ø–æ—Ä—Ç(–Ω–∞–ø—Ä–∏–º–µ—Ä curl http://127.0.0.1:5001). –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –≤ –ø–æ—Ä—Ç 8090."
    else:
        ip_display = final_ip

    return f'TIME: {current_time}, IP: {ip_display}'


# --- 5. –û—Ç–ª–∞–¥–æ—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç ---
@app.get("/debug")
def debug_headers(request: Request):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –æ—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è IP"""
    return {
        "headers": dict(request.headers),
        "client_host": request.client.host if request.client else None,
        "x_forwarded_for": request.headers.get('x-forwarded-for'),
        "real_ip": request.headers.get('x-real-ip'),
        "forwarded": request.headers.get('forwarded')
    }


# --- 6. –≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–ø–∏—Å–µ–π –≤ –ë–î ---
@app.get("/requests")
def get_requests():
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏"""
    try:
        with get_db_connection() as db:
            cursor = db.cursor()
            query = f"SELECT id, request_date, request_ip FROM `{db_table}` ORDER BY id DESC LIMIT 50"
            cursor.execute(query)
            records = cursor.fetchall()
            cursor.close()

            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∑–∞–ø–∏—Å–∏ –≤ —á–∏—Ç–∞–±–µ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
            result = []
            for record in records:
                result.append({
                    "id": record[0],
                    "request_date": record[1].strftime("%Y-%m-%d %H:%M:%S") if record[1] else None,
                    "request_ip": record[2]
                })

            return {
                "total_records": len(result),
                "records": result
            }
    except mysql.connector.Error as err:
        return {"error": f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {err}"}


# --- 7. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ---
# –î–ª—è –∑–∞–ø—É—Å–∫–∞ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ASGI-—Å–µ—Ä–≤–µ—Ä, –Ω–∞–ø—Ä–∏–º–µ—Ä, uvicorn.
# –ö–æ–º–∞–Ω–¥–∞: uvicorn main:app --reload
if __name__ == '__main__':
    import uvicorn
    uvicorn.run(app, host='0.0.0.0', port=5000)
```
## **–ó–∞–¥–∞—á–∞ 2***
–ù–∞—Å—Ç—Ä–æ–µ–Ω –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω Yandex Container Registry –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤. –°–æ–±—Ä–∞–Ω–Ω—ã–π –æ–±—Ä–∞–∑ Python-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω –≤ —Ä–µ–µ—Å—Ç—Ä. –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–∞ –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –æ—Ç—á–µ—Ç–∞ –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.


–û—Ç—á–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:
```json
[
  {
    "id": "chesg1i37iairok8226i",
    "image_id": "crp14i6nrb3urbqmiv60",
    "scanned_at": "2026-01-25T18:03:57.424Z",
    "status": "READY",
    "vulnerabilities": {
      "high": "2",
      "medium": "14",
      "low": "51"
    }
  }
]
```
## **–ó–∞–¥–∞—á–∞ 3**
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω `compose.yaml` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–∏—Ä–µ–∫—Ç–∏–≤—ã `include` –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è `proxy.yaml`. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –¥–≤–∞ —Å–µ—Ä–≤–∏—Å–∞ (`web` –∏ `db`) –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π —Å–µ—Ç–∏ `backend` —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ IP-–∞–¥—Ä–µ—Å–∞–º–∏. –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MySQL. –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å–≤—è–∑–∫–∏ —á–µ—Ä–µ–∑ curl-–∑–∞–ø—Ä–æ—Å—ã –∏ SQL-–∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.


![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/2/3.png)

## **–ó–∞–¥–∞—á–∞ 4**
–†–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ –≤ Yandex Cloud —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º Docker. –ù–∞–ø–∏—Å–∞–Ω –∏ –∑–∞–ø—É—â–µ–Ω bash-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ fork-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è. –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞ –∏–∑–≤–Ω–µ —á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫—É `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí Internet ‚Üí Nginx ‚Üí HAProxy ‚Üí FastAPI ‚Üí HAProxy ‚Üí Nginx ‚Üí Internet ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å`. –ù–∞—Å—Ç—Ä–æ–µ–Ω —É–¥–∞–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç SSH –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Docker.


![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/2/4.png)

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/2/4-1.png)

[–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–æ—Ä–∫](https://github.com/slateeho/devops-netology/tree/main/shvirtd-example-python)


## **–ó–∞–¥–∞—á–∞ 5***
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î MySQL —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ `schnitzler/mysqldump`. –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω bash-—Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞–º–ø–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π.

–°–∫—Ä–∏–ø—Ç:

```shell
#!/bin/bash
set -e

cd /opt/shvirtd-example-python
source .env

mkdir -p /opt/backup
sudo chmod 777 /opt/backup

now=$(date +"%s_%Y-%m-%d_%H-%M-%S")

docker compose exec -T db mysqldump --opt \
  --no-tablespaces \
  -u "${MYSQL_USER}" \
  -p"${MYSQL_PASSWORD}" \
  "${MYSQL_DATABASE}" \
  > "/opt/backup/${now}_${MYSQL_DATABASE}.sql"
```

cron-task:
```shell
echo '* * * * * /usr/local/bin/mysql-backup.sh >> /var/log/mysql-backup.log 2>&1' | crontab -
```

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/2/5.png)

## **–ó–∞–¥–∞—á–∞ 6**
–ò–∑—É—á–µ–Ω—ã —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏–∑ Docker-–æ–±—Ä–∞–∑–æ–≤. –í—ã–ø–æ–ª–Ω–µ–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ `/bin/terraform` –∏–∑ –æ–±—Ä–∞–∑–∞ `hashicorp/terraform:latest` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É—Ç–∏–ª–∏—Ç—ã `dive` –∏ –∫–æ–º–∞–Ω–¥—ã `docker save`. –ü—Ä–æ—Ü–µ—Å—Å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã `docker cp` –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–æ–¥—Ö–æ–¥–æ–≤.

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/2/6.png)

## **–ó–∞–¥–∞—á–∞ 6.1**
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ñ–∞–π–ª–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥—ã `docker build` –∏ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ Dockerfile. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç–æ–π —Å–±–æ—Ä–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ–º–æ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞.

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/2/6-1.png)

## **–ó–∞–¥–∞—á–∞ 6.2 (**)** :
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –º–µ—Ç–æ–¥ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥—É `docker build` –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π Dockerfile —Å –º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç–æ–π —Å–±–æ—Ä–∫–æ–π.

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/2/6-2.png)

## **–ó–∞–¥–∞—á–∞ 7 (***)**
–ü—Ä–æ–≤–µ–¥–µ–Ω –∑–∞–ø—É—Å–∫ Python http —Å–µ—Ä–≤–µ—Ä–∞ —Å –ø–æ–º–æ—â—å—é runC –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Docker –∏–ª–∏ containerd. –ü–æ–¥–Ω—è—Ç–∞ alpine rootfs, –Ω–∞ –æ—Å–Ω–æ–≤–µ https://github.com/opencontainers/runtime-spec/blob/main/config.md  –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω runc `config.json`, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—É—Ä–∫—Ç—É—Ä–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –ø—Ä–∏–ª–æ–∂–µ–Ω—ã —Å–∫—Ä–∏–Ω—à–æ—Ç—ã —Ä–∞–±–æ—Ç—ã–∏ http —Å–µ—Ä–≤–µ—Ä–∞.
/home/a/backup-script.sh
1) https://github.com/alealexpro100/linux_install/blob/master/bin/alpine-bootstrap - —Å–æ–∑–¥–∞–Ω–∏–µ rootfs c —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π python3.

2)

–≤–∞—Ä–∏–∞–Ω—Ç a) `config.json` root –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä c –ª–∏–º–∏—Ç–∞–º–∏\Control Group v2:

```json
{
  "ociVersion": "1.3.0",
  "process": {
    "terminal": true,
    "user": {
      "uid": 0,
      "gid": 0
    },
    "args": [
      "python3",
      "/server.py"
    ],
    "env": [
      "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
      "TERM=xterm"
    ],
    "cwd": "/",
    "capabilities": {
      "bounding": [
        "CAP_AUDIT_WRITE",
        "CAP_KILL",
        "CAP_NET_BIND_SERVICE"
      ],
      "effective": [
        "CAP_AUDIT_WRITE",
        "CAP_KILL",
        "CAP_NET_BIND_SERVICE"
      ],
      "permitted": [
        "CAP_AUDIT_WRITE",
        "CAP_KILL",
        "CAP_NET_BIND_SERVICE"
      ]
    },
    "rlimits": [
      {
        "type": "RLIMIT_NOFILE",
        "hard": 1024,
        "soft": 1024
      }
    ],
    "noNewPrivileges": true
  },
  "id": "http-py-app",
  "bundle": "/app",
  "root": {
    "path": "rootfs",
    "readonly": false
  },
  "hostname": "alpine-http",
  "mounts": [
    {
      "destination": "/proc",
      "type": "proc",
      "source": "proc"
    },
    {
      "destination": "/dev",
      "type": "tmpfs",
      "source": "tmpfs",
      "options": [
        "nosuid",
        "strictatime",
        "mode=755",
        "size=65536k"
      ]
    },
    {
      "destination": "/dev/pts",
      "type": "devpts",
      "source": "devpts",
      "options": [
        "nosuid",
        "noexec",
        "newinstance",
        "ptmxmode=0666",
        "mode=0620",
        "gid=5"
      ]
    }
  ],
  "linux": {
    "cgroupsPath": "http-py-app",
    "resources": {
      "memory": {
        "limit": 268435456,
        "swap": 0,
        "disableOOMKiller": false
      },
      "cpu": {
        "cpus": "0",
        "shares": 512,
        "quota": 5000,
        "period": 100000
      },
      "pids": {
        "limit": 256
      },
      "devices": [
        {
          "allow": true,
          "access": "rwm"
        }
      ]
    },
    "unified": {
      "io.max": "259:0 rbps=1048576 wiops=10\n253:0 rbps=1048576 wiops=10"
    },
    "memoryPolicy": {
      "mode": "MPOL_LOCAL"
    },
    "seccomp": {
      "defaultAction": "SCMP_ACT_ALLOW",
      "architectures": [
        "SCMP_ARCH_X86",
        "SCMP_ARCH_X32"
      ],
      "syscalls": [
        {
          "names": ["ptrace", "mount", "umount2", "kexec_load", "open_by_handle_at"],
          "action": "SCMP_ACT_ERRNO"
        }
      ]
    },
    "maskedPaths": ["/proc/acpi", "/proc/kcore", "/proc/kmem", "/proc/kmsg", "/proc/mem", "/proc/sysrq-trigger"],
    "namespaces": [
      {
        "type": "pid"
      },
      {
        "type": "network",
        "path": "/var/run/netns/alpine_network"
      },
      {
        "type": "ipc"
      },
      {
        "type": "uts"
      },
      {
        "type": "mount"
      },
      {
        "type": "cgroup"
      },
      {
        "type": "user"
      }
    ],
    "uidMappings": [
      {
        "containerID": 0,
        "hostID": 0,
        "size": 65536
      }
    ],
    "gidMappings": [
      {
        "containerID": 0,
        "hostID": 0,
        "size": 65536
      }
    ]
  },
  "annotations": {
    "app": "http-server"
  }
}
```

–±) –≤–∞—Ä–∏–∞–Ω—Ç rootless –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –ª–∏–º–∏—Ç–æ–º CPU\Mem:

```json
{
	"ociVersion": "1.3.0",
	"process": {
		"terminal": false,
		"user": {
			"uid": 0,
			"gid": 0
		},
		"args": [
			"python3",
			"/server.py"
		],
		"env": [
			"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
			"TERM=xterm"
		],
		"cwd": "/",
		"capabilities": {
			"bounding": [
				"CAP_AUDIT_WRITE",
				"CAP_KILL",
				"CAP_NET_BIND_SERVICE",
				"CAP_SYS_ADMIN",
				"CAP_NET_ADMIN"
			],
			"effective": [
				"CAP_AUDIT_WRITE",
				"CAP_KILL",
				"CAP_NET_BIND_SERVICE",
				"CAP_SYS_ADMIN",
				"CAP_NET_ADMIN"
			],
			"permitted": [
				"CAP_AUDIT_WRITE",
				"CAP_KILL",
				"CAP_NET_BIND_SERVICE",
				"CAP_SYS_ADMIN",
				"CAP_NET_ADMIN"
			]
		},
		"rlimits": [
			{
				"type": "RLIMIT_NOFILE",
				"hard": 1024,
				"soft": 1024
			}
		],
		"noNewPrivileges": true
	},
	"root": {
		"path": "rootfs",
		"readonly": false
	},
	"hostname": "runc",
	"mounts": [
		{
			"destination": "/proc",
			"type": "proc",
			"source": "proc"
		},
		{
			"destination": "/dev",
			"type": "tmpfs",
			"source": "tmpfs",
			"options": [
				"nosuid",
				"strictatime",
				"mode=755",
				"size=65536k"
			]
		},
		{
			"destination": "/dev/pts",
			"type": "devpts",
			"source": "devpts",
			"options": [
				"nosuid",
				"noexec",
				"newinstance",
				"ptmxmode=0666",
				"mode=0620"
			]
		},
		{
			"destination": "/dev/shm",
			"type": "tmpfs",
			"source": "shm",
			"options": [
				"nosuid",
				"noexec",
				"nodev",
				"mode=1777",
				"size=65536k"
			]
		},
		{
			"destination": "/dev/mqueue",
			"type": "mqueue",
			"source": "mqueue",
			"options": [
				"nosuid",
				"noexec",
				"nodev"
			]
		},
		{
			"destination": "/sys",
			"type": "none",
			"source": "/sys",
			"options": [
				"rbind",
				"nosuid",
				"noexec",
				"nodev",
				"ro"
			]
		},
		{
			"destination": "/sys/fs/cgroup",
			"type": "cgroup",
			"source": "cgroup",
			"options": [
				"nosuid",
				"noexec",
				"nodev",
				"relatime",
				"ro"
			]
		}
	],
	"linux": {
		"uidMappings": [
			{
				"containerID": 0,
				"hostID": 1000,
				"size": 1
			}
		],
		"gidMappings": [
			{
				"containerID": 0,
				"hostID": 1000,
				"size": 1
			}
		],
		"namespaces": [
			{
				"type": "pid"
			},
			{
				"type": "ipc"
			},
			{
				"type": "uts"
			},
			{
				"type": "mount"
			},
			{
				"type": "cgroup"
			},
			{
				"type": "user"
			}
		],
		"maskedPaths": [
			"/proc/acpi",
			"/proc/asound",
			"/proc/kcore",
			"/proc/keys",
			"/proc/latency_stats",
			"/proc/timer_list",
			"/proc/timer_stats",
			"/proc/sched_debug",
			"/sys/firmware",
			"/proc/scsi"
		],
		"readonlyPaths": [
			"/proc/bus",
			"/proc/fs",
			"/proc/irq",
			"/proc/sys",
			"/proc/sysrq-trigger"
		]
	}
}
```


3) –°–µ—Ç—å:

```bash
#!/bin/bash


if [[ $EUID -ne 0 ]]; then
   echo "This script must be run as root"
   exit 1
fi

set -e

if ! command -v iptables &> /dev/null; then
   pacman -Sy --noconfirm iptables
fi

if ! command -v iptables-save &> /dev/null; then
   pacman -Sy --noconfirm iptables-nft
fi

pacman -Sy --noconfirm shadow dbus

sudo -u "#1000" yay -S libcgroup rootlesskit slirp4netns libcgroup libwrap --noconfirm


systemctl enable netfilter-persistent
systemctl start netfilter-persistent

NETNS="alpine_network"
VETH_HOST="veth-host"
VETH_ALPINE="veth-alpine"
IP_SUBNET="192.168.10.1/24"
IP_GATEWAY="192.168.10.1"

ip netns add $NETNS
ip link add name $VETH_HOST type veth peer name $VETH_ALPINE
ip link set $VETH_ALPINE netns $NETNS
ip netns exec $NETNS ip link set lo up
ip netns exec $NETNS ip addr add $IP_SUBNET dev $VETH_ALPINE
ip netns exec $NETNS ip link set $VETH_ALPINE up
ip link set $VETH_HOST up
ip route add $IP_GATEWAY/32 dev $VETH_HOST
ip netns exec $NETNS ip route add default via $IP_GATEWAY dev $VETH_ALPINE

sleep 2

iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT

iptables -A INPUT -i lo -j ACCEPT
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
iptables -A INPUT -p tcp --dport 22 -j ACCEPT
iptables -A INPUT -p tcp --dport 80 -j ACCEPT
iptables -A INPUT -p tcp --dport 443 -j ACCEPT
iptables -A INPUT -p tcp --dport 8080 -j ACCEPT

iptables -A FORWARD -i $VETH_HOST -j ACCEPT
iptables -A FORWARD -o $VETH_HOST -j ACCEPT
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE

iptables-save > /etc/iptables/iptables.rules
```
–í—ã–≤–æ–¥ `tree -L2 /app`:<t_Ä˝>,√Ω:q""√Ω√Ω

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/app_structure.png)

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/app_state.png)

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/web_face.png)

Rootless:

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ_–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ_Docker/rootless.png)

</details>



<details>
<summary>6. –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–º Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ Docker Swarm</summary>


![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è_–∫–ª–∞—Å—Ç–µ—Ä–æ–º_Docker_–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤_–Ω–∞_–ø—Ä–∏–º–µ—Ä–µ_Docker_Swarm/1.png)

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è_–∫–ª–∞—Å—Ç–µ—Ä–æ–º_Docker_–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤_–Ω–∞_–ø—Ä–∏–º–µ—Ä–µ_Docker_Swarm/2.png)

![Docker –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è_–∫–ª–∞—Å—Ç–µ—Ä–æ–º_Docker_–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤_–Ω–∞_–ø—Ä–∏–º–µ—Ä–µ_Docker_Swarm/3.png)


</details>

